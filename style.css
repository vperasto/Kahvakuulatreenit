/* Google Fonts */
@import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600&display=swap');

:root {
  --bg-dark: #121212;
  --bg-panel: #1f1f1f;
  --text-main: #ffffff;
  --text-subtle: #aaaaaa;
  --accent-blue: #2196f3;
  --accent-orange: #ff9800;
  --accent-green: #4caf50;
  --accent-red: #f44336;
  --font-main: 'Rajdhani', sans-serif;
}

/* Basic Reset & Body */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 16px; /* Base font size */
}

body {
  font-family: var(--font-main);
  background-color: var(--bg-dark);
  color: var(--text-main);
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  line-height: 1.5;
}

#app {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden; /* Prevent body scrollbars from layout shifts */
}

/* Header */
header {
  background-color: var(--bg-panel);
  padding: 1rem 2rem;
  font-weight: 600;
  text-align: center;
  border-bottom: 2px solid var(--accent-blue);
  position: relative;
  flex-shrink: 0; /* Prevent header shrinking */
}

header h1 {
  margin: 0;
  font-size: clamp(1.5rem, 4vw, 1.8rem); /* Responsive font size */
}

#toggle-training-select {
  position: absolute;
  top: 50%;
  right: 1rem;
  transform: translateY(-50%);
  background-color: var(--accent-orange);
  color: var(--text-main);
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 5px;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 600;
}
#toggle-training-select:hover {
  background-color: #e68900;
}

/* Training Selection Section */
#training-select {
  background-color: var(--bg-panel);
  padding: 1rem 1.5rem;
  border-bottom: 1px solid #333;
  transition: max-height 0.3s ease-out, padding 0.3s ease-out, opacity 0.3s ease-out;
  max-height: 600px; /* Adjust as needed */
  overflow-y: auto; /* Allow scroll if content exceeds max-height */
  opacity: 1;
  flex-shrink: 0; /* Prevent shrinking */
}
#training-select.hidden {
  max-height: 0;
  padding-top: 0;
  padding-bottom: 0;
  opacity: 0;
  border-bottom: none;
  overflow: hidden;
}
#training-select h2 {
  margin-top: 0;
  margin-bottom: 1rem;
  font-size: 1.4rem;
  color: var(--accent-orange);
  text-align: center;
}

/* Week Buttons */
#week-buttons-container {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin-bottom: 1.5rem;
  justify-content: center;
}
.week-button {
  background-color: var(--accent-blue);
  color: var(--text-main);
  border: none;
  padding: 0.6rem 1.2rem;
  border-radius: 5px;
  cursor: pointer;
  font-size: 0.95rem;
  font-family: var(--font-main);
  font-weight: 600;
  transition: background-color 0.2s, transform 0.1s;
  flex-grow: 1;
  text-align: center;
  min-width: 160px; /* Minimum width for readability */
}
.week-button:hover {
  background-color: #1a78c2;
}
.week-button.active {
  background-color: var(--accent-green);
  transform: scale(1.02);
  box-shadow: 0 0 8px rgba(76, 175, 80, 0.5);
}

/* Default Time Settings */
.default-time-settings {
  background-color: #2a2a2a;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1.5rem;
}
.default-time-settings h3 {
  margin-top: 0;
  margin-bottom: 0.75rem;
  font-size: 1.1rem;
  color: var(--accent-orange);
}
.time-input-group {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}
.time-input-group label {
  width: 100px;
  text-align: right;
  font-size: 0.95rem;
  flex-shrink: 0;
}
.default-time-settings input[type="number"] {
  padding: 0.4rem 0.6rem;
  background-color: #333;
  color: var(--text-main);
  border: 1px solid var(--accent-blue);
  border-radius: 4px;
  font-family: var(--font-main);
  width: 80px;
}
.default-time-settings small {
  display: block;
  margin-top: 0.5rem;
  font-size: 0.85rem;
  color: var(--text-subtle);
}

/* Preset Workout Selection */
.preset-select-container {
    margin-top: 1.5rem;
}
.preset-select-container h3 {
  margin-top: 0;
  margin-bottom: 0.5rem;
  font-size: 1.1rem;
}
#training-dropdown {
  width: 100%;
  padding: 0.5rem;
  background-color: #333;
  color: var(--text-main);
  border: 1px solid var(--accent-blue);
  border-radius: 4px;
  font-family: var(--font-main);
}

/* Main Content Area */
main {
  display: grid;
  grid-template-columns: auto auto 1fr; /* List, Instructions, Display */
  gap: 1rem;
  padding: 1rem;
  flex: 1; /* Takes remaining vertical space */
  overflow: hidden; /* IMPORTANT: Prevents main from causing body scroll */
  min-height: 0; /* Fix for flexbox overflow in some browsers */
}

/* Common styles for aside/section in main */
main > aside, main > section {
  background-color: var(--bg-panel);
  border-radius: 8px;
  padding: 1rem;
  display: flex;
  flex-direction: column;
  overflow-y: auto; /* Allow internal scrolling */
  scrollbar-width: thin;
  scrollbar-color: var(--accent-blue) #333;
  /* Removed max-height - let the grid row handle height */
}

/* Exercise List (Left Column) */
aside#exercise-list {
   /* Let grid column define width */
   /* max-width: 300px; REMOVED - use grid column */
}
#exercise-list h2 {
  margin-top: 0;
  margin-bottom: 1rem;
  color: var(--accent-orange);
  font-size: 1.3rem;
  text-align: center;
}
#exercise-items {
  list-style: none;
  padding: 0;
  margin: 0;
  flex-grow: 1; /* Allow list to take space */
  min-height: 0; /* Flexbox fix */
}
#exercise-items li {
  margin-bottom: 0.5rem;
  padding: 0.75rem 1rem;
  background-color: #2a2a2a;
  border-left: 4px solid var(--accent-blue);
  cursor: pointer;
  transition: background-color 0.2s, border-color 0.2s, border-left-width 0.2s, color 0.2s;
  font-size: 1.1rem; /* Increased font size */
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
#exercise-items li:hover {
  background-color: #383838;
}
#exercise-items li.active {
  background-color: #3c3c3c;
  border-left-color: var(--accent-green);
  border-left-width: 6px;
  font-weight: 600;
  color: var(--accent-green);
}

/* Next Exercise Highlight Animation */
@keyframes subtle-pulse {
  0%, 100% { border-left-color: var(--accent-orange); }
  50% { border-left-color: var(--accent-blue); }
}
#exercise-items li.next-up {
  border-left-width: 5px;
  animation: subtle-pulse 1.5s infinite ease-in-out;
}

/* Workout Instructions (Middle Column) */
aside#workout-instructions {
   /* max-width: 350px; REMOVED - use grid column */
}
#workout-instructions h2 {
   margin-top: 0;
   margin-bottom: 1rem;
   color: var(--accent-orange);
   font-size: 1.3rem;
   text-align: center;
}
#workout-notes-container {
  width: 100%;
  margin: 0 auto 1rem auto;
  padding: 0.75rem 1rem;
  background-color: rgba(0, 0, 0, 0.2);
  border-left: 4px solid var(--accent-orange);
  border-radius: 4px;
  flex-grow: 1; /* Allow notes to take space */
  overflow-y: auto; /* Allow scrolling for long notes */
  min-height: 50px; /* Ensure minimum visible area */
}
#workout-notes {
  color: var(--accent-orange);
  font-size: 1rem;
  line-height: 1.4;
  text-align: left;
  white-space: pre-wrap; /* Preserve line breaks from JSON */
  margin: 0;
}

/* Exercise Display (Right Column) */
section#exercise-display {
  padding: 1rem 1.5rem;
  overflow: hidden; /* Prevent internal content overflow */
  display: flex; /* Use flex to manage children */
  flex-direction: column; /* Stack title and content-split */
  min-height: 0; /* Flexbox fix */
}
#title-area {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  /* max-width: 600px; REMOVED - Allow flexiblity */
  margin: 0 auto 1.5rem auto; /* Center title area */
  flex-shrink: 0; /* Prevent title area shrinking */
}
#exercise-display h2#exercise-name {
  margin: 0 1rem;
  font-size: clamp(1.5rem, 4vw, 2rem); /* Slightly smaller max for title */
  font-weight: 600;
  color: var(--text-main);
  flex-grow: 1;
  text-align: center;
}
.title-nav-btn {
  background: none;
  border: 2px solid var(--accent-blue);
  color: var(--accent-blue);
  border-radius: 50%;
  width: 40px;
  height: 40px;
  font-size: 1.2rem;
  padding: 0;
  cursor: pointer;
  transition: background-color 0.2s, color 0.2s, opacity 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}
.title-nav-btn:hover:not(:disabled) {
  background-color: var(--accent-blue);
  color: var(--text-main);
}
.title-nav-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
  border-color: #555;
  color: #555;
}

/* Content Split within Exercise Display */
#content-split {
  display: grid;
  grid-template-columns: 1fr 1fr; /* Image/Desc | Timer/Controls */
  gap: 2rem;
  width: 100%;
  flex: 1; /* Take remaining vertical space */
  align-items: start; /* Align items to the top of their grid cell */
  overflow: hidden; /* Prevent split content overflow */
  min-height: 0; /* Flexbox fix */
}
#exercise-details { /* Left side of split */
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  overflow-y: auto; /* Scroll if needed */
  max-height: 100%; /* Fit within parent grid cell */
  padding-right: 0.5rem; /* Space for scrollbar */
  scrollbar-width: thin;
  scrollbar-color: var(--accent-blue) #333;
}
#exercise-display img#exercise-image {
  display: block; /* Remove extra space below image */
  max-width: 100%;
  width: auto; /* Maintain aspect ratio */
  max-height: 400px; /* Default max height */
  height: auto; /* Maintain aspect ratio */
  object-fit: contain;
  border-radius: 8px;
  margin-bottom: 1rem;
  background-color: #2a2a2a;
}
#exercise-description {
  color: var(--text-subtle);
  font-size: 1.1rem;
  line-height: 1.5;
  max-width: 95%;
  text-align: left;
  margin-top: 0.5rem;
}

/* Timer and Controls (Right side of split) */
#timer-and-controls {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center; /* Center vertically within its column */
  height: 100%; /* Fill the grid cell height */
  gap: 1.5rem; /* Increased gap */
  min-height: 0; /* Flexbox fix */
}
#timer {
  text-align: center;
  /* Removed margin-bottom, handled by gap */
}
#time-remaining {
  font-size: clamp(3rem, 10vw, 5rem); /* Allow timer to be larger */
  font-weight: 600;
  color: var(--accent-blue);
  display: block;
  line-height: 1; /* Prevent large line height */
}
#timer-label {
  font-size: clamp(1rem, 3vw, 1.3rem);
  color: var(--text-subtle);
  margin-top: 0.2rem;
}
.control-button {
  background-color: var(--accent-blue);
  color: var(--text-main);
  border: none;
  border-radius: 6px;
  padding: 0.9rem 1.5rem;
  font-size: 1.2rem;
  font-family: var(--font-main);
  cursor: pointer;
  transition: background-color 0.2s, opacity 0.2s;
  font-weight: 600;
  width: 80%;
  max-width: 250px;
}
.control-button:hover:not(:disabled) { /* Specific hover defined below */}
#start-btn { background-color: var(--accent-green); }
#start-btn:hover:not(:disabled) { background-color: #388e3c; }
#pause-btn { background-color: var(--accent-orange); }
#pause-btn:hover:not(:disabled) { background-color: #e68900; }
#pause-btn.paused { background-color: var(--accent-green); }
#pause-btn.paused:hover:not(:disabled) { background-color: #388e3c; }
#stop-btn { background-color: var(--accent-red); }
#stop-btn:hover:not(:disabled) { background-color: #d32f2f; }
.control-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  background-color: #555 !important;
}

/* --- Responsiveness --- */

/* Tablet Landscape & Larger Tablets */
@media (max-width: 1024px) {
    /* Adjust grid layout slightly */
    main {
        grid-template-columns: minmax(200px, auto) minmax(220px, auto) 1fr; /* Give sidebars min/max */
        gap: 0.75rem;
        padding: 0.75rem;
    }
    main > aside, main > section {
         padding: 0.75rem;
    }

    /* Exercise Display Specific Adjustments for Tablet Landscape */
    section#exercise-display {
      padding: 1rem; /* Slightly more padding */
    }
    #content-split {
        gap: 1.5rem; /* Slightly less gap */
    }
    #exercise-display img#exercise-image {
        max-height: 350px; /* Reduce max image height slightly for landscape */
    }
     #exercise-display h2#exercise-name {
        font-size: clamp(1.4rem, 3.5vw, 1.8rem); /* Adjust title size */
    }
    #time-remaining {
        font-size: clamp(3rem, 9vw, 4.5rem); /* Adjust timer size */
    }
    .control-button {
        padding: 0.8rem 1.2rem;
        font-size: 1.1rem;
    }

    /* Week buttons adjustments */
    .week-button {
      min-width: 140px; /* Adjust min-width */
      flex-basis: calc(33.33% - 1rem); /* Attempt 3 columns */
    }
}

/* Tablet Portrait & Mobile */
@media (max-width: 768px) {
  #training-select { padding: 1rem; max-height: 80vh; overflow-y: auto; }
  #week-buttons-container { flex-direction: column; gap: 0.5rem; align-items: stretch; }
  .week-button { flex-basis: auto; min-width: unset; }

  .default-time-settings { padding: 0.75rem; }
  .time-input-group { flex-direction: column; align-items: flex-start; gap: 0.2rem; margin-bottom: 0.75rem; }
  .time-input-group label { width: auto; text-align: left; }
  .default-time-settings input[type="number"] { width: 100%; }

  main {
      grid-template-columns: 1fr; /* Stack all columns */
      grid-template-rows: auto auto 1fr; /* List, Instructions, Display - Display takes remaining space */
      overflow-y: auto; /* Allow main area to scroll */
      padding: 0.5rem;
      gap: 0.5rem;
  }
  main > aside, main > section {
      overflow-y: visible; /* Let main scroll handle it */
      padding: 0.75rem;
      /* max-height: none; -> Let grid row define height */
  }
  aside#exercise-list {
     max-width: 100%;
     max-height: 200px; /* Keep list scrollable and limited */
     overflow-y: auto;
     order: 1;
     flex-grow: 0; /* Don't let list grow infinitely */
     flex-shrink: 0; /* Prevent shrinking */
  }
  aside#workout-instructions {
     max-width: 100%;
     max-height: 180px; /* Keep instructions scrollable and limited */
     overflow-y: auto;
     order: 2;
     flex-grow: 0; /* Don't let instructions grow infinitely */
     flex-shrink: 0; /* Prevent shrinking */
  }
   #workout-instructions h2 { font-size: 1.1rem; margin-bottom: 0.5rem; }
   #workout-notes-container { padding: 0.5rem 0.75rem; }
   #workout-notes { font-size: 0.9rem; }

  /* Exercise Display Specific Adjustments for Tablet Portrait / Mobile */
  section#exercise-display {
      max-width: 100%;
      order: 3;
      padding: 1rem 0.75rem;
      flex-grow: 1; /* Allow display area to take remaining space */
      min-height: 0; /* Crucial for flex children */
  }
  #title-area { margin-bottom: 1rem; }
  #exercise-display h2#exercise-name {
      font-size: clamp(1.3rem, 4vw, 1.6rem); /* Responsive title */
      margin: 0 0.5rem;
  }
  .title-nav-btn { width: 35px; height: 35px; font-size: 1rem; }

  #content-split {
    grid-template-columns: 1fr; /* Stack content */
    gap: 1rem; /* Less gap when stacked */
    align-items: center; /* Center items vertically when stacked */
    overflow-y: auto; /* Allow split itself to scroll if needed */
    flex: 1; /* Take available space */
    min-height: 0; /* Flexbox fix */
  }
  #timer-and-controls {
      order: 1; /* Timer first */
      justify-content: flex-start; /* Align controls to top */
      height: auto; /* Don't force full height */
      gap: 1rem;
      padding-bottom: 1rem; /* Space at bottom */
  }
  #exercise-details {
      order: 2; /* Image/Desc second */
      padding-right: 0;
      max-height: none; /* Allow natural height */
      overflow-y: visible; /* Don't need internal scroll */
  }
  #exercise-display img#exercise-image {
      max-height: 280px; /* Slightly larger image for portrait tablet vs pure mobile */
      width: 100%; /* Allow image to take width */
      object-fit: contain;
  }
  #exercise-description {
      font-size: 1rem;
      text-align: center; /* Center description text */
  }

  .control-button {
      width: 90%;
      padding: 0.8rem 1rem;
      font-size: 1.1rem;
  }
  #time-remaining {
      font-size: clamp(3rem, 8vw, 3.5rem); /* Slightly smaller timer */
  }
  #timer-label {
      font-size: 1.1rem;
  }
}

/* Very small devices adjustments (optional) */
@media (max-width: 360px) {
    header { padding: 0.75rem 1rem; }
    header h1 { font-size: 1.3rem; }
    #toggle-training-select { padding: 0.4rem 0.8rem; font-size: 0.8rem; }
    main { padding: 0.25rem; gap: 0.25rem; }
    main > aside, main > section { padding: 0.5rem; }
    aside#exercise-list { max-height: 150px; }
    #exercise-items li { font-size: 1rem; padding: 0.6rem 0.8rem;}
    aside#workout-instructions { max-height: 120px; }
    section#exercise-display { padding: 0.75rem 0.5rem; }
    #exercise-display h2#exercise-name { font-size: 1.2rem; }
    #exercise-display img#exercise-image { max-height: 200px; }
    #time-remaining { font-size: 2.8rem; }
    .control-button { font-size: 1rem; padding: 0.7rem 0.9rem; }
}
